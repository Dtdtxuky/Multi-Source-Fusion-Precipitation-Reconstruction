2024-12-24 21:56:35,962 INFO    MainThread:148874 [wandb_setup.py:_flush():79] Current SDK version is 0.18.6
2024-12-24 21:56:35,965 INFO    MainThread:148874 [wandb_setup.py:_flush():79] Configure stats pid to 148874
2024-12-24 21:56:35,966 INFO    MainThread:148874 [wandb_setup.py:_flush():79] Loading settings from /mnt/petrelfs/xukaiyi/.config/wandb/settings
2024-12-24 21:56:35,967 INFO    MainThread:148874 [wandb_setup.py:_flush():79] Loading settings from /mnt/petrelfs/xukaiyi/CodeSpace/DiT/wandb/settings
2024-12-24 21:56:35,968 INFO    MainThread:148874 [wandb_setup.py:_flush():79] Loading settings from environment variables: {}
2024-12-24 21:56:35,969 INFO    MainThread:148874 [wandb_setup.py:_flush():79] Applying setup settings: {'mode': None, '_disable_service': None}
2024-12-24 21:56:35,970 INFO    MainThread:148874 [wandb_setup.py:_flush():79] Inferring run settings from compute environment: {'program_relpath': 'evaluation.py', 'program_abspath': '/mnt/petrelfs/xukaiyi/CodeSpace/DiT/evaluation.py', 'program': '/mnt/petrelfs/xukaiyi/CodeSpace/DiT/evaluation.py'}
2024-12-24 21:56:35,971 INFO    MainThread:148874 [wandb_setup.py:_flush():79] Applying login settings: {}
2024-12-24 21:56:35,972 INFO    MainThread:148874 [wandb_init.py:_log_setup():533] Logging user logs to ./Experiment/wandb/run-20241224_215635-gabblpbz/logs/debug.log
2024-12-24 21:56:35,973 INFO    MainThread:148874 [wandb_init.py:_log_setup():534] Logging internal logs to ./Experiment/wandb/run-20241224_215635-gabblpbz/logs/debug-internal.log
2024-12-24 21:56:35,974 INFO    MainThread:148874 [wandb_init.py:init():619] calling init triggers
2024-12-24 21:56:35,975 INFO    MainThread:148874 [wandb_init.py:init():626] wandb.init called with sweep_config: {}
config: {'tensor_model_parallel_size': 1, 'resume': False, 'resume_from_config': False, 'seed': 0, 'cuda': 0, 'world_size': 4, 'per_cpus': 4, 'local_rank': 0, 'init_method': 'tcp://10.140.24.64:10262', 'outdir': '/mnt/petrelfs/xukaiyi/CodeSpace/CasCast_DiT/Experiment/cascast_diffusion_100M', 'cfg': '/mnt/petrelfs/xukaiyi/CodeSpace/CasCast_DiT/configs/sevir_used/cascast_diffusion_100M.yaml', 'desc': 'Dif_tiny', 'visual_vars': None, 'debug': False, 'resume_checkpoint': None, 'resume_cfg_file': None, 'mydataset': 'Dif', 'wandb_name': 'DiT_00M', 'rank': 0, 'distributed': True, 'dist_backend': 'nccl', 'relative_checkpoint_dir': 'cascast_diffusion_100M/world_size4-Dif_tiny/2024-12-07_18-34-32', 'sevir': {'type': 'sevir_latent', 'input_length': 13, 'pred_length': 12, 'total_length': 25, 'base_freq': '5min', 'data_dir': 'radar:s3://sevir_latent', 'latent_gt_dir': '/mnt/petrelfs/xukaiyi/CodeSpace/CasCast/latent_data', 'latent_deterministic_dir': 'path/to/latent_prediction', 'latent_size': '32x32x1'}, 'dataset': {'train': {'type': 'sevir_latent', 'input_length': 13, 'pred_length': 12, 'total_length': 25, 'base_freq': '5min', 'data_dir': 'radar:s3://sevir_latent', 'latent_gt_dir': '/mnt/petrelfs/xukaiyi/CodeSpace/CasCast/latent_data', 'latent_deterministic_dir': 'path/to/latent_prediction', 'latent_size': '32x32x1'}, 'valid': {'type': 'sevir_latent', 'input_length': 13, 'pred_length': 12, 'total_length': 25, 'base_freq': '5min', 'data_dir': 'radar:s3://sevir_latent', 'latent_gt_dir': '/mnt/petrelfs/xukaiyi/CodeSpace/CasCast/latent_data', 'latent_deterministic_dir': 'path/to/latent_prediction', 'latent_size': '32x32x1'}, 'test': {'type': 'sevir_latent', 'input_length': 13, 'pred_length': 12, 'total_length': 25, 'base_freq': '5min', 'data_dir': 'radar:s3://sevir_latent', 'latent_gt_dir': '/mnt/petrelfs/xukaiyi/CodeSpace/CasCast/latent_data', 'latent_deterministic_dir': 'path/to/latent_prediction', 'latent_size': '32x32x1'}}, 'sampler': {'type': 'TrainingSampler'}, 'dataloader': {'num_workers': 8, 'pin_memory': False, 'prefetch_factor': 2, 'persistent_workers': True}, 'trainer': {'batch_size': 1, 'valid_batch_size': 1, 'max_epoch': 1, 'max_step': 100000}, 'model': {'type': 'latent_diffusion_model', 'params': {'diffusion_kwargs': {'noise_scheduler': {'DDPMScheduler': {'num_train_timesteps': 2000, 'beta_start': 0.0001, 'beta_end': 0.02, 'beta_schedule': 'linear', 'clip_sample_range': 13, 'prediction_type': 'epsilon'}}, 'classifier_free_guidance': {'p_uncond': 0.1, 'guidance_weight': 1}}, 'sub_model': {'casformer': {'arch': 'DiT-custom', 'config': {'input_size': 32, 'in_channels': 10, 'mlp_ratio': 4.0, 'learn_sigma': False, 'out_channels': 1, 'split_num': 12, 'num_heads': 16, 'single_heads_num': 4, 'hidden_size': 512, 'enc_hidden_size': 256, 'patch_size': 2, 'enc_depth': 16, 'latent_depth': 16}}, 'autoencoder_kl': {'in_channels': 1, 'out_channels': 1, 'down_block_types': ['DownEncoderBlock2D', 'DownEncoderBlock2D', 'DownEncoderBlock2D', 'DownEncoderBlock2D'], 'up_block_types': ['UpDecoderBlock2D', 'UpDecoderBlock2D', 'UpDecoderBlock2D', 'UpDecoderBlock2D'], 'block_out_channels': [128, 256, 512, 512], 'layers_per_block': 2, 'latent_channels': 1, 'norm_num_groups': 32}}, 'save_best': 'MSE', 'use_ceph': False, 'ceph_checkpoint_path': 'mpas:s3://sevir/checkpoint', 'metrics_type': 'None', 'data_type': 'fp32', 'visualizer': {'visualizer_type': 'sevir_visualizer', 'visualizer_step': 4000}, 'optimizer': {'casformer': {'type': 'AdamW', 'params': {'lr': 0.001, 'betas': [0.9, 0.95]}}}, 'lr_scheduler': {'casformer': {'by_step': True, 'sched': 'cosine', 'epochs': 1, 'min_lr': 1e-05, 'warmup_lr': 1e-05, 'warmup_epochs': 0.02, 'lr_noise': None, 'cooldown_epochs': 0}}, 'extra_params': {'loss_type': 'MSELoss', 'enabled_amp': False, 'log_step': 20, 'predictor_checkpoint_path': 'None', 'autoencoder_checkpoint_path': '/mnt/petrelfs/xukaiyi/CodeSpace/DiT/ckpt/ae_checkpoint_latest.pth', 'save_epoch_interval': 5}}}}
2024-12-24 21:56:35,976 INFO    MainThread:148874 [wandb_init.py:init():669] starting backend
2024-12-24 21:56:35,977 INFO    MainThread:148874 [wandb_init.py:init():673] sending inform_init request
2024-12-24 21:56:35,980 INFO    MainThread:148874 [backend.py:_multiprocessing_setup():104] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-12-24 21:56:35,981 INFO    MainThread:148874 [wandb_init.py:init():686] backend started and connected
2024-12-24 21:56:35,986 INFO    MainThread:148874 [wandb_init.py:init():781] updated telemetry
2024-12-24 21:56:36,016 INFO    MainThread:148874 [wandb_init.py:init():814] communicating run to backend with 90.0 second timeout
2024-12-24 21:56:36,710 INFO    MainThread:148874 [wandb_init.py:init():867] starting run threads in backend
2024-12-24 21:56:37,283 INFO    MainThread:148874 [wandb_run.py:_console_start():2451] atexit reg
2024-12-24 21:56:37,284 INFO    MainThread:148874 [wandb_run.py:_redirect():2299] redirect: wrap_raw
2024-12-24 21:56:37,286 INFO    MainThread:148874 [wandb_run.py:_redirect():2364] Wrapping output streams.
2024-12-24 21:56:37,287 INFO    MainThread:148874 [wandb_run.py:_redirect():2389] Redirects installed.
2024-12-24 21:56:37,294 INFO    MainThread:148874 [wandb_init.py:init():911] run started, returning control to user process
